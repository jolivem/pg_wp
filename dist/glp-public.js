(()=>{(function(s){s(function(){var p=!0,r=!1,y;function h(){let e=document.getElementById("images_id");if(e){let a=e.value.split(",");if(a.length>1){let t=document.getElementById("post_id").value,i=d=>d==t,n=a.findIndex(i);if(n!=-1){let d=n+1;document.getElementById("cpt-photo").innerHTML=d+"/"+a.length,n==0&&s(".fa-angle-double-left").css("color","darkgray"),n==a.length-1&&s(".fa-angle-double-right").css("color","darkgray")}}}}h(),s(document).on("touchstart",function(e){y=e.originalEvent.touches[0].clientY}),s(document).on("touchend",".lg-image",function(e){var a=e.originalEvent.changedTouches[0].clientY;y==a&&(r?(clearTimeout(r),r=null):r=setTimeout(function(){p?(s(document).find(".lg-icon,.lg-sub-html,.lg-toolbar").fadeOut("fast"),p=!1):(s(document).find(".lg-icon,.lg-sub-html,.lg-toolbar").fadeOut().toggle("fast"),p=!0),r=null},200),e.preventDefault())}),s(document).find("#gallery_help").on("change",function(e){let a=!1;e.target.checked&&(a=!0);let t=document.getElementById("pg_admin_ajax_url").value,i=document.getElementById("pg_nonce").value,n=new FormData;n.append("action","hide_gallery_help"),n.append("nonce",i),n.append("hide",a),jQuery.ajax({method:"POST",url:t,data:n,contentType:!1,processData:!1,success:function(){console.log("hide_gallery_help success")}})}),s(document).find("#galleries_help").on("change",function(e){let a=!1;e.target.checked&&(a=!0);let t=document.getElementById("pg_admin_ajax_url").value,i=document.getElementById("pg_nonce").value,n=new FormData;n.append("action","hide_galleries_help"),n.append("nonce",i),n.append("hide",a),jQuery.ajax({method:"POST",url:t,data:n,contentType:!1,processData:!1,success:function(){console.log("hide_galleries_help success")}})}),s(document).find("#user-galleries-create").on("click",function(e){let a=document.getElementById("pg_edit_gallery_url").value;a+="?gid=-1",window.location=a}),s(document).find(".admin-photo-option").on("click",function(e){e.preventDefault();let a=e.target.dataset.postid,t=document.getElementById("pg_nonce")?.value,i=document.getElementById("pg_admin_ajax_url")?.value,n="address"+a,d=document.querySelector('input[name="'+n+'"]:checked').value,o=new FormData;o.append("nonce",t),o.append("address",d),o.append("pid",a),e.target.classList.contains("fa-thumbs-up")&&(o.append("action","admin_valid_photo"),jQuery.ajax({method:"POST",url:i,data:o,contentType:!1,processData:!1,success:function(c){let l=e.target.parentNode.parentNode;l.style.animationDuration=".35s",l.style.animationName="slideOutRight",setTimeout(()=>{l.remove()},300);var u=[].slice.call(document.querySelectorAll(".toast"));u.map(function(m){return new bootstrap.Toast(m)})}})),e.target.classList.contains("fa-thumbs-down")&&(o.append("action","admin_reject_photo"),jQuery.ajax({method:"POST",url:i,data:o,contentType:!1,processData:!1,success:function(c){let l=e.target.parentNode.parentNode;l.style.animationDuration=".35s",l.style.animationName="slideOutLeft",setTimeout(()=>{l.remove()},300);var u=[].slice.call(document.querySelectorAll(".toast"));u.map(function(m){return new bootstrap.Toast(m)})}}))}),s(document).find(".admin-url-option").on("click",function(e){e.preventDefault();let a=e.target.dataset.userid,t=document.getElementById("pg_nonce").value,i=document.getElementById("pg_admin_ajax_url").value,n=new FormData;n.append("nonce",t),n.append("uid",a),e.target.classList.contains("fa-thumbs-up")&&(n.append("action","admin_valid_url"),jQuery.ajax({method:"POST",url:i,data:n,contentType:!1,processData:!1,success:function(d){let o=e.target.parentNode.parentNode;o.style.animationDuration=".35s",o.style.animationName="slideOutRight",setTimeout(()=>{o.remove()},300);var c=[].slice.call(document.querySelectorAll(".toast"));c.map(function(l){return new bootstrap.Toast(l)})}})),e.target.classList.contains("fa-thumbs-down")&&(n.append("action","admin_reject_url"),jQuery.ajax({method:"POST",url:i,data:n,contentType:!1,processData:!1,success:function(d){let o=e.target.parentNode.parentNode;o.style.animationDuration=".35s",o.style.animationName="slideOutLeft",setTimeout(()=>{o.remove()},300);var c=[].slice.call(document.querySelectorAll(".toast"));c.map(function(l){return new bootstrap.Toast(l)})}}))}),s(document).find(".edit-photo-option").on("click",function(e){e.preventDefault();let t=document.getElementById("images_id").value.split(",");if(t.length>1){let i=e.target.dataset.postid,n=o=>o==i,d=t.findIndex(n);if(d!=-1){if(e.target.classList.contains("fa-angle-double-right")){if(d<t.length-1){let c=t[d+1],l=document.getElementById("pg_edit_photo_url").value;l+="?pid=",l+=c;let u=document.getElementById("gallery-id").value;l+="&gid=",l+=u,window.location=l}}else if(e.target.classList.contains("fa-angle-double-left")&&d>0){let c=t[d-1],l=document.getElementById("pg_edit_photo_url").value;l+="?pid=",l+=c;let u=document.getElementById("gallery-id").value;l+="&gid=",l+=u,window.location=l}let o=d+1;document.getElementById("cpt-photo").innerHTML=o+"/"+t.length}}}),s(document).find("#btn-add-single-photo").on("click",function(e){e.preventDefault();let a=e.target.dataset.galid,t=document.getElementById("pg_download_single_url").value;t+="?gid=",t+=a,window.location=t}),s(document).find(".user-photo-option").on("click",function(e){if(e.preventDefault(),e.target.classList.contains("fa-edit")){let a=e.target.dataset.postid,t=document.getElementById("pg_edit_photo_url").value;t+="?pid=",t+=a,window.location=t}if(e.target.classList.contains("fa-trash")){let a=e.target.dataset.postid;e.preventDefault();let t=document.getElementById("pg_nonce").value,i=document.getElementById("pg_admin_ajax_url").value,n=new FormData;n.append("action","user_delete_photo"),n.append("nonce",t),n.append("pid",a),jQuery.ajax({method:"POST",url:i,data:n,contentType:!1,processData:!1,success:function(d){let o=e.target.parentNode.parentNode;o.style.animationDuration=".35s",o.style.animationName="slideOutLeft",setTimeout(()=>{o.remove()},300);var c=[].slice.call(document.querySelectorAll(".toast"));c.map(function(m){return new bootstrap.Toast(m)});var l=document.getElementById("delete-photo-success"),u=bootstrap.Toast.getInstance(l);u.show()}})}}),s(document).find(".user-gallery-option").on("click",function(e){if(e.target.classList.contains("fa-edit")){let a=e.target.dataset.galid,t=document.getElementById("pg_edit_gallery_url").value;t+="?gid=",t+=a,window.location=t}else if(e.target.classList.contains("fa-eye")){let a=e.target.dataset.galuuid,t=document.getElementById("pg_show_gallery_url").value;t+="?guuid=",t+=a,window.location=t}else if(e.target.classList.contains("fa-share-alt")){let a=e.target.dataset.galuuid,t=document.getElementById("pg_show_gallery_url").value;t+="?guuid=",t+=a,navigator.clipboard.writeText(t).then(()=>{var i=[].slice.call(document.querySelectorAll(".toast"));i.map(function(o){return new bootstrap.Toast(o)});var n=document.getElementById("copy-to-clipboard"),d=bootstrap.Toast.getInstance(n);d.show()})}e.preventDefault()}),s(document).find("#modal-delete-gallery").on("click",function(e){let a=document.getElementById("gallery-id").value;e.preventDefault();let t=document.getElementById("pg_nonce").value,i=document.getElementById("pg_admin_ajax_url").value,n=new FormData;n.append("action","user_delete_gallery"),n.append("nonce",t),n.append("gid",a),jQuery.ajax({method:"POST",url:i,data:n,contentType:!1,processData:!1,success:function(d){let o=document.getElementById("pg_user_galleries_url").value;window.location=o}})}),s(document).find(".gallery-photo-option").on("click",function(e){if(e.preventDefault(),e.target.classList.contains("fa-edit")){let a=e.target.parentElement.dataset.id,t=document.getElementById("pg_edit_photo_url").value;t+="?pid=",t+=a;let i=document.getElementById("gallery-id").value;t+="&gid=",t+=i,window.location=t}if(e.target.classList.contains("fa-trash")){let a=e.target.parentNode.parentNode.parentNode;a.style.animationDuration=".35s",a.style.animationName="slideOutLeft",setTimeout(()=>{a.remove()},300)}}),s(document).on("click",".lg-image",function(e){r?(clearTimeout(r),r=null):r=setTimeout(function(){p?(s(document).find(".lg-icon,.lg-sub-html,.lg-toolbar").fadeOut("fast"),p=!1):(s(document).find(".lg-icon,.lg-sub-html,.lg-toolbar").fadeOut().toggle("fast"),p=!0),r=null},200),e.preventDefault()});let _=e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);s(document).find("#contact-mail").on("click",function(e){e.preventDefault();let a=!0;s(".invalid-input").css("display","none");let t=document.getElementById("email");(t.value==""||!_(t.value))&&(s("#email").parent().find(".invalid-input").css("display","block"),a=!1);let i=document.getElementById("contact-message");if(i.value==""&&(s("#contact-message").parent().find(".invalid-input").css("display","block"),a=!1),a==!0){let n=document.getElementById("pg_nonce").value,d=document.getElementById("pg_admin_ajax_url").value,o=new FormData;o.append("action","contact_mail"),o.append("nonce",n),o.append("email",t.value),o.append("msg",i.value),jQuery.ajax({method:"POST",url:d,data:o,contentType:!1,processData:!1,success:function(){var c=[].slice.call(document.querySelectorAll(".toast"));c.map(function(m){return new bootstrap.Toast(m)});var l=document.getElementById("contact-success"),u=bootstrap.Toast.getInstance(l);u.show()}})}}),s("#user_status").on("change",function(e){this.value=this.checked?"public":"private",this.checked?document.getElementById("user_status_label").textContent="Affichage autoris\xE9 sur la galerie publique":document.getElementById("user_status_label").textContent="Photo priv\xE9e",e.stopPropagation()}),s(document).find("#save-photo").on("click",function(e){e.preventDefault();let a=!1,t=document.getElementById("post_id").value,i=document.getElementById("pg_nonce").value,n=document.getElementById("pg_admin_ajax_url").value,d=document.getElementById("photo-description").value,o=document.getElementById("user_status").value,c=new FormData;c.append("action","user_edit_photo"),c.append("nonce",i),c.append("post_id",t),c.append("desc",d),c.append("user_status",o),jQuery.ajax({method:"POST",url:n,data:c,contentType:!1,processData:!1,success:function(l){var u=[].slice.call(document.querySelectorAll(".toast"));u.map(function(E){return new bootstrap.Toast(E)});var m=document.getElementById("save-photo-success"),v=bootstrap.Toast.getInstance(m);v.show()}})});function f(){let e=document.getElementById("gallery-id").value,a=document.getElementById("pg_nonce").value,t=document.getElementById("pg_admin_ajax_url").value,i=document.getElementById("gallery-title").value,n=document.getElementById("gallery-description").value,d=[];if(document.getElementById("item-list")){let c=document.getElementById("item-list").children;for(let l=0;l<c.length;l++)d.push(c[l].dataset.id)}let o=new FormData;o.append("action","user_edit_gallery"),o.append("nonce",a),o.append("gallery_id",e),o.append("title",i),o.append("desc",n),o.append("images_id",d),jQuery.ajax({method:"POST",url:t,data:o,contentType:!1,processData:!1,success:function(c){var l=[].slice.call(document.querySelectorAll(".toast"));l.map(function(v){return new bootstrap.Toast(v)});var u=document.getElementById("save-gallery-success"),m=bootstrap.Toast.getInstance(u);m.show()}})}s(document).find("#edit-gallery-save").on("click",function(e){e.preventDefault(),f()}),s(document).find("#edit-gallery-save-2").on("click",function(e){e.preventDefault(),f()})})})(jQuery);var g=document.querySelector(".sortable-list");if(g){g.querySelectorAll(".item").forEach(r=>{r.addEventListener("dragstart",()=>{setTimeout(()=>r.classList.add("dragging"),0)}),r.addEventListener("dragend",()=>r.classList.remove("dragging"))});let p=r=>{r.preventDefault();let y=document.querySelector(".dragging"),_=[...g.querySelectorAll(".item:not(.dragging)")].find(f=>r.pageY<=f.offsetTop+f.offsetHeight/2);g.insertBefore(y,_)};g.addEventListener("dragover",p),g.addEventListener("dragenter",r=>r.preventDefault())}})();
